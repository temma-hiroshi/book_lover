<div class="container my-5">
  <div class="my-5 border border-2 bg-light py-4">
    <h2 class="mt-4 text-center">本の情報</h2>
    <div class="d-flex">
      <%= render "shared/book_icon" %>
      <div class="col-4 my-5">
        <div class="mb-5 py-3 px-5 border border-1 bg-white">
          <h3>タイトル</h3>
          <p class="book-element"><%= @book.title %></p>
          <h3>著者</h3>
          <p class="book-element"><%= @book.author %></p>
          <h3>説明文</h3>
          <p class="book-element"><%= @book.description %></p>
        </div>
        <div class="mb-5 py-3 px-5 border border-1 bg-white">
          <h4>本の登録者</h4>
          <p class="book-user"><%= @book.user.name %></p>
        </div>
        <% if user_signed_in? && @book.user_id == current_user.id %>
          <%= link_to "編集", edit_book_path(@book.id), class: "btn btn-primary my-3 col-5" %><br>
        <% end %>
        <%= link_to "トップページに戻る", home_index_path, class: "btn btn-secondary my-3 col-5" %>
      </div>
    </div>
  </div>
  <div class="comment-container w-75 mx-auto my-5 text-center border border-2 bg-light py-4">
    <h3 class="my-5">コメント一覧</h3>
    <table>
      <thead>
        <tr>
          <th class="px-5 col-2">アイコン</th>
          <th class="px-5 col-2">投稿者</th>
          <th class="px-5 col-8">コメント</th>
        </tr>
      </thead>
      <tbody>
      <% @book.comments.each do |comment| %>
        <tr>
          <td class="py-2 px-5 col-2">
            <% if comment.user.image.attached? %>
              <%= image_tag current_user.image, class: "rounded-circle" %>
            <% else %>
              <%= image_tag "noimage-user.jpg", class: "rounded-circle" %>
            <% end %>
          </td>
          <td class="py-2 px-5 col-2"><%= comment.user.name %></td>
          <td class="py-2 px-5 col-8"><%= comment.comment %><br></td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <div class="form-container my-3 py-3">
      <%= form_with(model: @comment, local: true, url: comments_path) do |form| %>
        <%= render "shared/error_messages", model: form.object %>
        <div class="text-area">
          <%= form.label :comment, "コメント", class: "col-2 mb-4 text-area-label" %>
          <%= form.text_area :comment, class: "col-4 mx-4 mb-4 text-area-input w-50" %><br>
        </div>

        <%= form.hidden_field :user_id, value: current_user.id %>
        <%= form.hidden_field :book_id, value: @book.id %>
        <%= form.submit "投稿", class: "btn btn-success col-2 mb-4" %><br>
      <% end %>
    </div>
  </div>
</div>
